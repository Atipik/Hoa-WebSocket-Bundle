<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
	<head>
		<meta http-equiv="Content-Language" content="en" />
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>hoa-websocket-bundle : code coverage of Atipik\Hoa\WebSocketBundle\WebSocket\Runner</title>
		<link rel="stylesheet" media="screen" type="text/css" href="../../../../screen.css" title="Screen" />
	</head>
	<body>
		<div id="header">
			<h1>Code coverage of <a href="../../../../">hoa-websocket-bundle</a>: Atipik\Hoa\WebSocketBundle\WebSocket\Runner</h1>
			<h2>Class code coverage <span>89.39%</span></h2>
		</div>
		<div id="page">
			<div id="content">
				<h3>Methods</h3>
				<ul class="summary">
					
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#__construct">__construct</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#addEvent">addEvent</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#addModule">addModule</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#getEventCallables">getEventCallables</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#getEvents">getEvents</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#getGroups">getGroups</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#getLogger">getLogger</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#getModules">getModules</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#getNodeClass">getNodeClass</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#getWebSocketServer">getWebSocketServer</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#hasEvent">hasEvent</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#init">init</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#initWebSocketServer">initWebSocketServer</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#launchModuleAction">launchModuleAction</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#loadEvents">loadEvents</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#onBinaryMessage">onBinaryMessage</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#onClose">onClose</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#onError">onError</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#onEvent">onEvent</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#onMessage">onMessage</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#onOpen">onOpen</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#onPing">onPing</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 0%"></div>
										<div class="label"><a href="#run">run</a> <span>0%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#setEvents">setEvents</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#setGroups">setGroups</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#setLogger">setLogger</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#setModules">setModules</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#setNodeClass">setNodeClass</a> <span>100%</span></div>
									</div>
								
							</li>
						
							<li>
								
								
									<div class="bar">
										<div class="background"></div>
										<div class="graph" style="width: 100%"></div>
										<div class="label"><a href="#setWebSocketServer">setWebSocketServer</a> <span>100%</span></div>
									</div>
								
							</li>
						
					
				</ul>
				<h3>Source</h3>
				<table cellpadding="0" cellspacing="0" class="source">
					<tr><th class="number">Line</th><th>Code</th></tr>
					<tr><td class="number"><a name="warning"></a>1</td><td><pre>&lt;?php
</pre></td></tr><tr><td class="number"><a name="warning"></a>2</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="warning"></a>3</td><td><pre>namespace Atipik\Hoa\WebSocketBundle\WebSocket;
</pre></td></tr><tr><td class="number"><a name="warning"></a>4</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="warning"></a>5</td><td><pre>use Atipik\Hoa\WebSocketBundle\Log\Logger;
</pre></td></tr><tr><td class="number"><a name="warning"></a>6</td><td><pre>use Atipik\Hoa\WebSocketBundle\WebSocket\Server as WebSocketServer;
</pre></td></tr><tr><td class="number"><a name="warning"></a>7</td><td><pre>use Hoa\Core\Event\Bucket;
</pre></td></tr><tr><td class="number"><a name="warning"></a>8</td><td><pre>use Symfony\Component\Console\Output\OutputInterface;
</pre></td></tr><tr><td class="number"><a name="warning"></a>9</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="warning"></a>10</td><td><pre>/**
</pre></td></tr><tr><td class="number"><a name="warning"></a>11</td><td><pre> * Bundle runner
</pre></td></tr><tr><td class="number"><a name="warning"></a>12</td><td><pre> *
</pre></td></tr><tr><td class="number"><a name="warning"></a>13</td><td><pre> * Called by command
</pre></td></tr><tr><td class="number"><a name="warning"></a>14</td><td><pre> * hoa.websocket.runner service
</pre></td></tr><tr><td class="number"><a name="warning"></a>15</td><td><pre> */
</pre></td></tr><tr><td class="number"><a name="warning"></a>16</td><td><pre>class Runner
</pre></td></tr><tr><td class="number"><a name="warning"></a>17</td><td><pre>{
</pre></td></tr><tr><td class="number"><a name="warning"></a>18</td><td><pre>    const DEFAULT_ADDRESS    = &#039;127.0.0.1&#039;;
</pre></td></tr><tr><td class="number"><a name="warning"></a>19</td><td><pre>    const DEFAULT_PORT       = &#039;8080&#039;;
</pre></td></tr><tr><td class="number"><a name="warning"></a>20</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="warning"></a>21</td><td><pre>    protected $events  = array();
</pre></td></tr><tr><td class="number"><a name="warning"></a>22</td><td><pre>    protected $groups  = array();
</pre></td></tr><tr><td class="number"><a name="warning"></a>23</td><td><pre>    protected $logger;
</pre></td></tr><tr><td class="number"><a name="warning"></a>24</td><td><pre>    protected $modules = array();
</pre></td></tr><tr><td class="number"><a name="warning"></a>25</td><td><pre>    protected $nodeClass;
</pre></td></tr><tr><td class="number"><a name="warning"></a>26</td><td><pre>    protected $webSocketServer;
</pre></td></tr><tr><td class="number"><a name="warning"></a>27</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="warning"></a>28</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="warning"></a>29</td><td><pre>     * Constructor
</pre></td></tr><tr><td class="number"><a name="warning"></a>30</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="warning"></a>31</td><td><pre>     * @param Hoa\Websocket\Server                  $webSocketServer
</pre></td></tr><tr><td class="number"><a name="warning"></a>32</td><td><pre>     * @param Atipik\Hoa\WebSocketBundle\Log\Logger $logger
</pre></td></tr><tr><td class="number"><a name="warning"></a>33</td><td><pre>     * @param string                                $nodeClass
</pre></td></tr><tr><td class="number"><a name="warning"></a>34</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="__construct"></a>35</td><td><pre>    public function __construct(WebSocketServer $webSocketServer, Logger $logger, $nodeClass = null)
</pre></td></tr><tr><td class="number"><a name="__construct"></a>36</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number">37</td><td><pre>        $this
</pre></td></tr><tr class="covered"><td class="number">38</td><td><pre>            -&gt;init()
</pre></td></tr><tr class="covered"><td class="number">39</td><td><pre>            -&gt;setLogger($logger)
</pre></td></tr><tr class="covered"><td class="number">40</td><td><pre>            -&gt;setNodeClass($nodeClass)
</pre></td></tr><tr class="covered"><td class="number">41</td><td><pre>            -&gt;setWebSocketServer($webSocketServer)
</pre></td></tr><tr class="covered"><td class="number">42</td><td><pre>        ;
</pre></td></tr><tr class="covered"><td class="number">43</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="__construct"></a>44</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="__construct"></a>45</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="__construct"></a>46</td><td><pre>     * Add an event and its callback
</pre></td></tr><tr><td class="number"><a name="__construct"></a>47</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="__construct"></a>48</td><td><pre>     * @param string   $event
</pre></td></tr><tr><td class="number"><a name="__construct"></a>49</td><td><pre>     * @param callable $callable
</pre></td></tr><tr><td class="number"><a name="__construct"></a>50</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>51</td><td><pre>    public function addEvent($event, $callable)
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>52</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number">53</td><td><pre>        if (!is_callable($callable)) {
</pre></td></tr><tr class="covered"><td class="number">54</td><td><pre>            throw new \InvalidArgumentException(
</pre></td></tr><tr class="covered"><td class="number">55</td><td><pre>                sprintf(
</pre></td></tr><tr class="covered"><td class="number">56</td><td><pre>                    &#039;%s expects parameter 2 to be callable, %s given: %s&#039;,
</pre></td></tr><tr class="covered"><td class="number">57</td><td><pre>                    __METHOD__,
</pre></td></tr><tr class="covered"><td class="number">58</td><td><pre>                    gettype($callable),
</pre></td></tr><tr class="covered"><td class="number">59</td><td><pre>                    print_r($callable, true)
</pre></td></tr><tr class="covered"><td class="number">60</td><td><pre>                )
</pre></td></tr><tr class="covered"><td class="number">61</td><td><pre>            );
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>62</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>63</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">64</td><td><pre>        if (!isset($this-&gt;events[$event])) {
</pre></td></tr><tr class="covered"><td class="number">65</td><td><pre>            $this-&gt;events[$event] = array();
</pre></td></tr><tr class="covered"><td class="number">66</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>67</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">68</td><td><pre>        $this-&gt;events[$event][] = $callable;
</pre></td></tr><tr class="covered"><td class="number">69</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>70</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>71</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>72</td><td><pre>     * Link module to this server
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>73</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>74</td><td><pre>     * Called by Atipik\Hoa\WebSocketBundle\DependencyInjection\Compiler\ModulesCompilerPass
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>75</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>76</td><td><pre>     * @param Atipik\Hoa\WebSocketBundle\WebSocket\Module\ModuleInterface $module
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>77</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>78</td><td><pre>     * @return self
</pre></td></tr><tr><td class="number"><a name="addEvent"></a>79</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="addModule"></a>80</td><td><pre>    public function addModule(Module\ModuleInterface $module)
</pre></td></tr><tr><td class="number"><a name="addModule"></a>81</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number">82</td><td><pre>        $this-&gt;modules[] = $module;
</pre></td></tr><tr><td class="number"><a name="addModule"></a>83</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number">84</td><td><pre>        return $this;
</pre></td></tr><tr><td class="number"><a name="addModule"></a>85</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="addModule"></a>86</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="addModule"></a>87</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="addModule"></a>88</td><td><pre>     * Returns callables event
</pre></td></tr><tr><td class="number"><a name="addModule"></a>89</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="addModule"></a>90</td><td><pre>     * @param string $event
</pre></td></tr><tr><td class="number"><a name="addModule"></a>91</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="addModule"></a>92</td><td><pre>     * @return array
</pre></td></tr><tr><td class="number"><a name="addModule"></a>93</td><td><pre>     */
</pre></td></tr><tr class="covered"><td class="number"><a name="getEventCallables"></a>94</td><td><pre>    public function getEventCallables($event)
</pre></td></tr><tr><td class="number"><a name="addModule"></a>95</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="getEventCallables"></a>96</td><td><pre>        return $this-&gt;hasEvent($event) ? $this-&gt;events[$event] : array();
</pre></td></tr><tr><td class="number"><a name="addModule"></a>97</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="addModule"></a>98</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="addModule"></a>99</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="addModule"></a>100</td><td><pre>     * Returns all events
</pre></td></tr><tr><td class="number"><a name="addModule"></a>101</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="addModule"></a>102</td><td><pre>     * @return array
</pre></td></tr><tr><td class="number"><a name="addModule"></a>103</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>104</td><td><pre>    public function getEvents()
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>105</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="getEventCallables"></a>106</td><td><pre>        return $this-&gt;events;
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>107</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>108</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>109</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>110</td><td><pre>     * Returns groups
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>111</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>112</td><td><pre>     * @return array
</pre></td></tr><tr><td class="number"><a name="getEvents"></a>113</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>114</td><td><pre>    public function getGroups()
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>115</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="getEventCallables"></a>116</td><td><pre>        return $this-&gt;groups;
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>117</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>118</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>119</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>120</td><td><pre>     * Returns current logger
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>121</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>122</td><td><pre>     * @return Atipik/Hoa/WebSocketBundle/Log/Logger
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>123</td><td><pre>     */
</pre></td></tr><tr class="covered"><td class="number"><a name="getLogger"></a>124</td><td><pre>    public function getLogger()
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>125</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="getLogger"></a>126</td><td><pre>        return $this-&gt;logger;
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>127</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>128</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>129</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>130</td><td><pre>     * Returns modules
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>131</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>132</td><td><pre>     * @return array
</pre></td></tr><tr><td class="number"><a name="getGroups"></a>133</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="getModules"></a>134</td><td><pre>    public function getModules()
</pre></td></tr><tr><td class="number"><a name="getModules"></a>135</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="getLogger"></a>136</td><td><pre>        return $this-&gt;modules;
</pre></td></tr><tr class="covered"><td class="number"><a name="getLogger"></a>137</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getModules"></a>138</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getModules"></a>139</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getModules"></a>140</td><td><pre>     * Returns current node class
</pre></td></tr><tr><td class="number"><a name="getModules"></a>141</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="getModules"></a>142</td><td><pre>     * @return string
</pre></td></tr><tr><td class="number"><a name="getModules"></a>143</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>144</td><td><pre>    public function getNodeClass()
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>145</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="getLogger"></a>146</td><td><pre>        return $this-&gt;nodeClass;
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>147</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>148</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>149</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>150</td><td><pre>     * Returns WebSocket server
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>151</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>152</td><td><pre>     * @return Hoa\Websocket\Server
</pre></td></tr><tr><td class="number"><a name="getNodeClass"></a>153</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>154</td><td><pre>    public function getWebSocketServer()
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>155</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="getLogger"></a>156</td><td><pre>        return $this-&gt;webSocketServer;
</pre></td></tr><tr class="covered"><td class="number"><a name="getLogger"></a>157</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>158</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>159</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>160</td><td><pre>     * Checks if an event with the name $event is registered
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>161</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>162</td><td><pre>     * @param string $event
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>163</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>164</td><td><pre>     * @return boolean
</pre></td></tr><tr><td class="number"><a name="getWebSocketServer"></a>165</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>166</td><td><pre>    public function hasEvent($event)
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>167</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="getLogger"></a>168</td><td><pre>        return array_key_exists($event, $this-&gt;events);
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>169</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>170</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>171</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>172</td><td><pre>     * Initialization
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>173</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>174</td><td><pre>     * @return self
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>175</td><td><pre>     */
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>176</td><td><pre>    public function init()
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>177</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>178</td><td><pre>        return $this
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>179</td><td><pre>            -&gt;setEvents(array())
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>180</td><td><pre>            -&gt;setGroups(array())
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>181</td><td><pre>            -&gt;setModules(array())
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>182</td><td><pre>            -&gt;setNodeClass(null)
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>183</td><td><pre>            -&gt;setLogger(null)
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>184</td><td><pre>            -&gt;setWebSocketServer(null)
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>185</td><td><pre>        ;
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>186</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>187</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>188</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>189</td><td><pre>     * Initialize WebSocket server
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>190</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>191</td><td><pre>     * @return Hoa\Websocket\Server
</pre></td></tr><tr><td class="number"><a name="hasEvent"></a>192</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>193</td><td><pre>    public function initWebSocketServer()
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>194</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>195</td><td><pre>        $webSocketServer = $this-&gt;getWebSocketServer();
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>196</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>197</td><td><pre>        $webSocketServer-&gt;setLogger(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>198</td><td><pre>            $this-&gt;getLogger()
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>199</td><td><pre>        );
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>200</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>201</td><td><pre>        if ($this-&gt;getNodeClass() !== null) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>202</td><td><pre>            $webSocketServer-&gt;getConnection()-&gt;setNodeName(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>203</td><td><pre>                $this-&gt;getNodeClass()
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>204</td><td><pre>            );
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>205</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>206</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>207</td><td><pre>        $socket = $webSocketServer-&gt;getConnection()-&gt;getSocket();
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>208</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>209</td><td><pre>        $this-&gt;getLogger()-&gt;log(&#039;&lt;fg=yellow&gt;Starting server...&lt;/fg=yellow&gt;&#039;);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>210</td><td><pre>        $this-&gt;getLogger()-&gt;log(&#039;Class used:&#039;);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>211</td><td><pre>        $this-&gt;getLogger()-&gt;log(&#039;  Logger           : %s&#039;, get_class($this-&gt;getLogger()));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>212</td><td><pre>        $this-&gt;getLogger()-&gt;log(&#039;  Runner           : %s&#039;, get_class($this));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>213</td><td><pre>        $this-&gt;getLogger()-&gt;log(&#039;  WebSocket Server : %s&#039;, get_class($webSocketServer));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>214</td><td><pre>        $this-&gt;getLogger()-&gt;log(&#039;  Socket Server    : %s&#039;, get_class($socket));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>215</td><td><pre>        $this-&gt;getLogger()-&gt;log(&#039;  Node             : %s&#039;, ltrim($webSocketServer-&gt;getConnection()-&gt;getNodeName(), &#039;\\&#039;));
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>216</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>217</td><td><pre>        $this-&gt;getLogger()-&gt;log(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>218</td><td><pre>            &#039;&lt;fg=yellow&gt;Listening on %s:%d&lt;/fg=yellow&gt;&#039;,
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>219</td><td><pre>            $socket-&gt;getAddress(),
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>220</td><td><pre>            $socket-&gt;getPort()
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>221</td><td><pre>        );
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>222</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>223</td><td><pre>        $webSocketServer-&gt;on(&#039;open&#039;, xcallable($this, &#039;onOpen&#039;));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>224</td><td><pre>        $webSocketServer-&gt;on(&#039;message&#039;, xcallable($this, &#039;onMessage&#039;));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>225</td><td><pre>        $webSocketServer-&gt;on(&#039;binary-message&#039;, xcallable($this, &#039;onBinaryMessage&#039;));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>226</td><td><pre>        $webSocketServer-&gt;on(&#039;ping&#039;, xcallable($this, &#039;onPing&#039;));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>227</td><td><pre>        $webSocketServer-&gt;on(&#039;error&#039;, xcallable($this, &#039;onError&#039;));
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>228</td><td><pre>        $webSocketServer-&gt;on(&#039;close&#039;, xcallable($this, &#039;onClose&#039;));
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>229</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>230</td><td><pre>        $this-&gt;loadEvents();
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>231</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>232</td><td><pre>        return $webSocketServer;
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>233</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>234</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>235</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>236</td><td><pre>     * Launch module action
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>237</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>238</td><td><pre>     * @param string                 $event
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>239</td><td><pre>     * @param Module\ModuleInterface $module
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>240</td><td><pre>     * @param string                 $method
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>241</td><td><pre>     * @param Bucket                 $bucket
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>242</td><td><pre>     * @param mixed                  $additionnalData
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>243</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>244</td><td><pre>     * @return boolean
</pre></td></tr><tr><td class="number"><a name="initWebSocketServer"></a>245</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>246</td><td><pre>    public function launchModuleAction($event, Module\ModuleInterface $module, $method, Bucket $bucket, $additionnalData = null)
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>247</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>248</td><td><pre>        $module-&gt;setBucket($bucket);
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>249</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>250</td><td><pre>        return call_user_func(
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>251</td><td><pre>            array(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>252</td><td><pre>                $module,
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>253</td><td><pre>                $method
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>254</td><td><pre>            ),
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>255</td><td><pre>            $additionnalData
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>256</td><td><pre>        );
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>257</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>258</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>259</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>260</td><td><pre>     * Load events
</pre></td></tr><tr><td class="number"><a name="launchModuleAction"></a>261</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>262</td><td><pre>    public function loadEvents()
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>263</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>264</td><td><pre>        $this-&gt;setEvents(array());
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>265</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>266</td><td><pre>        $groups  = $this-&gt;getGroups();
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>267</td><td><pre>        $modules = $this-&gt;getModules();
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>268</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>269</td><td><pre>        if (!empty($groups)) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>270</td><td><pre>            foreach ($modules as $key =&gt; $module) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>271</td><td><pre>                if (!in_array($module-&gt;getGroup(), $groups)) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>272</td><td><pre>                    unset($modules[$key]);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>273</td><td><pre>                }
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>274</td><td><pre>            }
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>275</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>276</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>277</td><td><pre>        foreach ($modules as $module) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>278</td><td><pre>            foreach ($module-&gt;getSubscribedEvents() as $eventName =&gt; $method) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>279</td><td><pre>                $this-&gt;addEvent(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>280</td><td><pre>                    $eventName,
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>281</td><td><pre>                    array(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>282</td><td><pre>                        $module,
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>283</td><td><pre>                        $method
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>284</td><td><pre>                    )
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>285</td><td><pre>                );
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>286</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>287</td><td><pre>                $log = array(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>288</td><td><pre>                    &#039;message&#039; =&gt; &#039;Listening &lt;fg=green&gt;%s&lt;/fg=green&gt; event &lt;fg=yellow&gt;%s&lt;/fg=yellow&gt;::&lt;fg=blue&gt;%s&lt;/fg=blue&gt;&#039;,
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>289</td><td><pre>                                 $eventName,
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>290</td><td><pre>                                 get_class($module),
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>291</td><td><pre>                                 $method
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>292</td><td><pre>                );
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>293</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>294</td><td><pre>                if (!empty($groups)) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>295</td><td><pre>                    $log[&#039;message&#039;] .= &#039; &lt;fg=cyan&gt;[%s group]&lt;/fg=cyan&gt;&#039;;
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>296</td><td><pre>                    $log[]           = $module-&gt;getGroup();
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>297</td><td><pre>                }
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>298</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>299</td><td><pre>                call_user_func_array(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>300</td><td><pre>                    array($this-&gt;getLogger(), &#039;log&#039;),
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>301</td><td><pre>                    $log
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>302</td><td><pre>                );
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>303</td><td><pre>            }
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>304</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>305</td><td><pre>            $module-&gt;onLoaded();
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>306</td><td><pre>        }
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>307</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>308</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>309</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>310</td><td><pre>     * Fire a &quot;binary message&quot; event
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>311</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>312</td><td><pre>     * @param Hoa\Core\Event\Bucket $bucket
</pre></td></tr><tr><td class="number"><a name="loadEvents"></a>313</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="onBinaryMessage"></a>314</td><td><pre>    public function onBinaryMessage(Bucket $bucket)
</pre></td></tr><tr><td class="number"><a name="onBinaryMessage"></a>315</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>316</td><td><pre>        $this-&gt;onEvent(&#039;binary-message&#039;, $bucket);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>317</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="onBinaryMessage"></a>318</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="onBinaryMessage"></a>319</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="onBinaryMessage"></a>320</td><td><pre>     * Fire a &quot;close&quot; event
</pre></td></tr><tr><td class="number"><a name="onBinaryMessage"></a>321</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="onBinaryMessage"></a>322</td><td><pre>     * @param Hoa\Core\Event\Bucket $bucket
</pre></td></tr><tr><td class="number"><a name="onBinaryMessage"></a>323</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="onClose"></a>324</td><td><pre>    public function onClose(Bucket $bucket)
</pre></td></tr><tr><td class="number"><a name="onClose"></a>325</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>326</td><td><pre>        $this-&gt;onEvent(&#039;close&#039;, $bucket);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>327</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="onClose"></a>328</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="onClose"></a>329</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="onClose"></a>330</td><td><pre>     * Fire a &quot;error&quot; event
</pre></td></tr><tr><td class="number"><a name="onClose"></a>331</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="onClose"></a>332</td><td><pre>     * @param Hoa\Core\Event\Bucket $bucket
</pre></td></tr><tr><td class="number"><a name="onClose"></a>333</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="onError"></a>334</td><td><pre>    public function onError(Bucket $bucket)
</pre></td></tr><tr><td class="number"><a name="onError"></a>335</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>336</td><td><pre>        $this-&gt;onEvent(&#039;error&#039;, $bucket);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>337</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="onError"></a>338</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="onError"></a>339</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="onError"></a>340</td><td><pre>     * Fire an event
</pre></td></tr><tr><td class="number"><a name="onError"></a>341</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="onError"></a>342</td><td><pre>     * @param string                $event
</pre></td></tr><tr><td class="number"><a name="onError"></a>343</td><td><pre>     * @param Hoa\Core\Event\Bucket $bucket
</pre></td></tr><tr><td class="number"><a name="onError"></a>344</td><td><pre>     * @param mixed                 $additionnalData
</pre></td></tr><tr><td class="number"><a name="onError"></a>345</td><td><pre>     * @param boolean               $log
</pre></td></tr><tr><td class="number"><a name="onError"></a>346</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="onError"></a>347</td><td><pre>     * @return void
</pre></td></tr><tr><td class="number"><a name="onError"></a>348</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>349</td><td><pre>    public function onEvent($event, Bucket $bucket, $additionnalData = null, $log = true)
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>350</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>351</td><td><pre>        $callables = $this-&gt;getEventCallables($event);
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>352</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>353</td><td><pre>        if ($log) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>354</td><td><pre>            $rawData = $bucket-&gt;getData();
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>355</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>356</td><td><pre>            $this-&gt;getLogger()-&gt;log(
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>357</td><td><pre>                &#039;%s - %s (%d) &gt; %s + %s&#039;,
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>358</td><td><pre>                $bucket-&gt;getSource()-&gt;getConnection()-&gt;getCurrentNode()-&gt;getId(),
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>359</td><td><pre>                $event,
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>360</td><td><pre>                count($callables),
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>361</td><td><pre>                json_encode($rawData, JSON_PRETTY_PRINT),
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>362</td><td><pre>                json_encode($additionnalData, JSON_PRETTY_PRINT)
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>363</td><td><pre>            );
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>364</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>365</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>366</td><td><pre>        if ($this-&gt;hasEvent($event)) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>367</td><td><pre>            foreach ($callables as $callable) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>368</td><td><pre>                list($module, $method) = $callable;
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>369</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>370</td><td><pre>                if ($this-&gt;launchModuleAction($event, $module, $method, $bucket, $additionnalData) === false) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>371</td><td><pre>                    break;
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>372</td><td><pre>                }
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>373</td><td><pre>            }
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>374</td><td><pre>        }
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>375</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>376</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>377</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>378</td><td><pre>     * Fire a &quot;message&quot; event
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>379</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>380</td><td><pre>     * @param Hoa\Core\Event\Bucket $bucket
</pre></td></tr><tr><td class="number"><a name="onEvent"></a>381</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="onMessage"></a>382</td><td><pre>    public function onMessage(Bucket $bucket)
</pre></td></tr><tr><td class="number"><a name="onMessage"></a>383</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>384</td><td><pre>        $this-&gt;onEvent(&#039;message&#039;, $bucket);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>385</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="onMessage"></a>386</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="onMessage"></a>387</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="onMessage"></a>388</td><td><pre>     * Fire a &quot;open&quot; event
</pre></td></tr><tr><td class="number"><a name="onMessage"></a>389</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="onMessage"></a>390</td><td><pre>     * @param Hoa\Core\Event\Bucket $bucket
</pre></td></tr><tr><td class="number"><a name="onMessage"></a>391</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="onOpen"></a>392</td><td><pre>    public function onOpen(Bucket $bucket)
</pre></td></tr><tr><td class="number"><a name="onOpen"></a>393</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>394</td><td><pre>        $this-&gt;onEvent(&#039;open&#039;, $bucket);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>395</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="onOpen"></a>396</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="onOpen"></a>397</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="onOpen"></a>398</td><td><pre>     * Fire a &quot;ping&quot; event
</pre></td></tr><tr><td class="number"><a name="onOpen"></a>399</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="onOpen"></a>400</td><td><pre>     * @param Hoa\Core\Event\Bucket $bucket
</pre></td></tr><tr><td class="number"><a name="onOpen"></a>401</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="onPing"></a>402</td><td><pre>    public function onPing(Bucket $bucket)
</pre></td></tr><tr><td class="number"><a name="onPing"></a>403</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>404</td><td><pre>        $this-&gt;onEvent(&#039;ping&#039;, $bucket);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>405</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="onPing"></a>406</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="onPing"></a>407</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="onPing"></a>408</td><td><pre>     * Run this server
</pre></td></tr><tr><td class="number"><a name="onPing"></a>409</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="onPing"></a>410</td><td><pre>     * @return boolean
</pre></td></tr><tr><td class="number"><a name="onPing"></a>411</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="run"></a>412</td><td><pre>    public function run()
</pre></td></tr><tr><td class="number"><a name="run"></a>413</td><td><pre>    {
</pre></td></tr><tr><td class="number"><a name="run"></a>414</td><td><pre>        try {
</pre></td></tr><tr class="notCovered"><td class="number">415</td><td><pre>            $this-&gt;initWebSocketServer()-&gt;run();
</pre></td></tr><tr><td class="number"><a name="run"></a>416</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">417</td><td><pre>            return true;
</pre></td></tr><tr class="notCovered"><td class="number">418</td><td><pre>        } catch (\Exception $e) {
</pre></td></tr><tr class="notCovered"><td class="number">419</td><td><pre>            $traces = array_reverse(explode(PHP_EOL, $e-&gt;getTraceAsString()));
</pre></td></tr><tr><td class="number"><a name="run"></a>420</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">421</td><td><pre>            foreach ($traces as $key =&gt; $trace) {
</pre></td></tr><tr class="notCovered"><td class="number">422</td><td><pre>                $trace = explode(&#039; &#039;, $trace, 2);
</pre></td></tr><tr><td class="number"><a name="run"></a>423</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">424</td><td><pre>                $traces[$key] = sprintf(
</pre></td></tr><tr class="notCovered"><td class="number">425</td><td><pre>                    &#039;#%s &gt; %s&#039;,
</pre></td></tr><tr class="notCovered"><td class="number">426</td><td><pre>                    str_pad($key + 1, strlen(count($traces)), &#039;0&#039;, STR_PAD_LEFT),
</pre></td></tr><tr class="notCovered"><td class="number">427</td><td><pre>                    $trace[1]
</pre></td></tr><tr class="notCovered"><td class="number">428</td><td><pre>                );
</pre></td></tr><tr class="notCovered"><td class="number">429</td><td><pre>            }
</pre></td></tr><tr><td class="number"><a name="run"></a>430</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">431</td><td><pre>            $this-&gt;getLogger()-&gt;error(
</pre></td></tr><tr class="notCovered"><td class="number">432</td><td><pre>                &quot;%s: %s\n%s&quot;,
</pre></td></tr><tr class="notCovered"><td class="number">433</td><td><pre>                get_class($e),
</pre></td></tr><tr class="notCovered"><td class="number">434</td><td><pre>                $e-&gt;getMessage(),
</pre></td></tr><tr class="notCovered"><td class="number">435</td><td><pre>                implode(&quot;\n&quot;, $traces)
</pre></td></tr><tr class="notCovered"><td class="number">436</td><td><pre>            );
</pre></td></tr><tr><td class="number"><a name="run"></a>437</td><td><pre>
</pre></td></tr><tr class="notCovered"><td class="number">438</td><td><pre>            return false;
</pre></td></tr><tr><td class="number"><a name="run"></a>439</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="run"></a>440</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="run"></a>441</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="run"></a>442</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="run"></a>443</td><td><pre>     * Set events array
</pre></td></tr><tr><td class="number"><a name="run"></a>444</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="run"></a>445</td><td><pre>     * @param array $events
</pre></td></tr><tr><td class="number"><a name="run"></a>446</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="run"></a>447</td><td><pre>     * @return self
</pre></td></tr><tr><td class="number"><a name="run"></a>448</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>449</td><td><pre>    public function setEvents(array $events)
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>450</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>451</td><td><pre>        $this-&gt;events = $events;
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>452</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>453</td><td><pre>        return $this;
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>454</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>455</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>456</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>457</td><td><pre>     * Set groups
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>458</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>459</td><td><pre>     * @param array $groups
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>460</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>461</td><td><pre>     * @return self
</pre></td></tr><tr><td class="number"><a name="setEvents"></a>462</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>463</td><td><pre>    public function setGroups(array $groups)
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>464</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>465</td><td><pre>        $this-&gt;groups = $groups;
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>466</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>467</td><td><pre>        return $this;
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>468</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>469</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>470</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>471</td><td><pre>     * Set current logger
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>472</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>473</td><td><pre>     * @param Atipik/Hoa/WebSocketBundle/Log/Logger $logger
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>474</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>475</td><td><pre>     * @return self
</pre></td></tr><tr><td class="number"><a name="setGroups"></a>476</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>477</td><td><pre>    public function setLogger(Logger $logger = null)
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>478</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>479</td><td><pre>        $this-&gt;logger = $logger;
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>480</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>481</td><td><pre>        return $this;
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>482</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>483</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>484</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>485</td><td><pre>     * Set modules
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>486</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>487</td><td><pre>     * @param array $modules
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>488</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>489</td><td><pre>     * @return self
</pre></td></tr><tr><td class="number"><a name="setLogger"></a>490</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="setModules"></a>491</td><td><pre>    public function setModules(array $modules)
</pre></td></tr><tr><td class="number"><a name="setModules"></a>492</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>493</td><td><pre>        $this-&gt;modules = array();
</pre></td></tr><tr><td class="number"><a name="setModules"></a>494</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>495</td><td><pre>        foreach ($modules as $module) {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>496</td><td><pre>            $this-&gt;addModule($module);
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>497</td><td><pre>        }
</pre></td></tr><tr><td class="number"><a name="setModules"></a>498</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>499</td><td><pre>        return $this;
</pre></td></tr><tr><td class="number"><a name="setModules"></a>500</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="setModules"></a>501</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="setModules"></a>502</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="setModules"></a>503</td><td><pre>     * Set node class
</pre></td></tr><tr><td class="number"><a name="setModules"></a>504</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setModules"></a>505</td><td><pre>     * @param string $class
</pre></td></tr><tr><td class="number"><a name="setModules"></a>506</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setModules"></a>507</td><td><pre>     * @return self
</pre></td></tr><tr><td class="number"><a name="setModules"></a>508</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>509</td><td><pre>    public function setNodeClass($class)
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>510</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>511</td><td><pre>        $this-&gt;nodeClass = $class;
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>512</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>513</td><td><pre>        return $this;
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>514</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>515</td><td><pre>
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>516</td><td><pre>    /**
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>517</td><td><pre>     * Set WebSocket server
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>518</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>519</td><td><pre>     * @param Hoa\Websocket\Server $webSocketServer
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>520</td><td><pre>     *
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>521</td><td><pre>     * @return self
</pre></td></tr><tr><td class="number"><a name="setNodeClass"></a>522</td><td><pre>     */
</pre></td></tr><tr><td class="number"><a name="setWebSocketServer"></a>523</td><td><pre>    public function setWebSocketServer(WebSocketServer $webSocketServer = null)
</pre></td></tr><tr><td class="number"><a name="setWebSocketServer"></a>524</td><td><pre>    {
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>525</td><td><pre>        $this-&gt;webSocketServer = $webSocketServer;
</pre></td></tr><tr><td class="number"><a name="setWebSocketServer"></a>526</td><td><pre>
</pre></td></tr><tr class="covered"><td class="number"><a name="init"></a>527</td><td><pre>        return $this;
</pre></td></tr><tr><td class="number"><a name="setWebSocketServer"></a>528</td><td><pre>    }
</pre></td></tr><tr><td class="number"><a name="setWebSocketServer"></a>529</td><td><pre>}</pre></td></tr>
				</table>
			</div>
		</div>
		<div id="footer">
			<p>Code coverage report powered by <a href="http://atoum.org">atoum</a></p>
		</div>
	</body>
</html>
